<html lang="en"><head> <meta charset="utf-8"> <title> Rendering of inline boxes depending on the element’s direction | Annotated CSS Spec </title> <meta name="description" content="Broaden your CSS knowledge by reading a specification enriched with explanations and examples."> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta property="og:title" content="Annotated CSS Spec"> <meta property="og:url" content="https://annotatedcss.com"> <meta property="og:description" content="Broaden your CSS knowledge by reading an annotated specification!"> <meta property="og:image" content="/images/logo.png"> <meta property="og:type" content="website"> <meta property="og:image:width" content="300"> <meta property="og:image:height" content="300"> <link href="https://fonts.googleapis.com/css2?family=Inconsolata&amp;family=Open+Sans:ital,wght@0,400;0,600;1,300;1,400&amp;display=swap" rel="stylesheet"> <link rel="canonical" href="https://annotatedcss.com/box-model/comments/8.6.2-5"> <link rel="stylesheet" href="/styles/main.css"> <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96"> </head> <body> <header> <svg class="logo" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 41.01 41.01"><g class="marginBox" fill="none" stroke="#ececfb" stroke-width="2.646"><path d="M1.323 7.938V1.323h6.615M1.323 11.898v6.614M1.323 22.488v6.614M7.937 39.688H1.323v-6.615M39.688 7.938V1.323h-6.615M39.688 11.898v6.614M39.688 22.488v6.614M33.073 39.688h6.614v-6.615M11.906 1.318h6.615M22.49 1.318h6.614M11.906 39.688h6.615M22.49 39.688h6.614"></path></g><rect class="borderBox" ry="0" height="25.261" width="25.261" y="7.87" x="7.875" opacity=".99" fill="none" stroke="#ececfb" stroke-width="2.52" stroke-linecap="round"></rect><rect class="contentBox" ry="0" height="14.552" width="14.552" y="13.23" x="13.229" opacity=".99" fill="#c7a6e7ff"></rect></svg> <a class="title" href="/">Annotated CSS&nbsp;Spec </a><a class="help-link" href="/about">?</a> </header> <main> <article class="spec-comment open" data-comment-on="/box-model.html"> <div class="content"> <div class="comment-identifier"> This comment relates to the following words from Section&nbsp;8.6 of CSS&nbsp;2.2: <blockquote> <p> When the element's <a href="https://www.w3.org/TR/CSS22/visuren.html#propdef-direction"><span class="propinst-direction">'direction'</span></a> property is 'ltr', the left-most generated box of the first line box in which the element appears has the left margin, left border and left padding, and the right-most generated box of the last line box in which the element appears has the right padding, right border and right margin. </p> <p> When the element's <a href="https://www.w3.org/TR/CSS22/visuren.html#propdef-direction"><span class="propinst-direction">'direction'</span></a> property is 'rtl', the right-most generated box of the first line box in which the element appears has the right padding, right border and right margin, and the left-most generated box of the last line box in which the element appears has the left margin, left border and left padding. </p> </blockquote> </div> <p> These two paragraphs elaborate on the first sentence of Section&nbsp;8.6. That is, they specify what exactly it means that browsers must <q>take the inline boxes generated for each element and render the margins, borders and padding in visual order (not logical order)</q>. </p> <p> The paragraphs describe two types of layout for inline boxes. The choice between them depends on the value of <code class="language-css">direction</code>. This property specifies, among other things, the base direction of the text, a concept discussed in the <a href="/box-model/comments/8.6.1">previous comment</a>. In the discussion here, I’ll assume you’ve read that comment. </p> <p> Note that apart from CSS’s <code class="language-css">direction</code>, there is also the attribute <code class="language-html">dir</code> in HTML. They have similar effects. The HTML option is <a href="https://www.w3.org/International/questions/qa-bidi-css-markup#markup">recommended by W3C</a> because <q>directionality is an integral part of the document structure</q>, and not just a stylistic consideration. The <a href="https://www.w3.org/TR/css-writing-modes-3/">CSS Writing Modes Level 3</a> spec even says: <q>Authors <em>should not</em> use ‘direction’ in HTML documents.</q> </p> <p> When you set the <code class="language-html">dir</code> attribute and leave the <code class="language-css">direction</code> property unspecified, the browser will usually apply the value of <code class="language-html">dir</code> to <code class="language-css">direction</code>. For this reason, in the following example, I’ll only use <code class="language-html">dir</code>. </p> <h3> Inline box layout when <code class="language-css">direction</code> is <code class="language-css">ltr</code> </h3> <p> The first paragraph of the commented fragment describes a layout that should probably be expected by those of you who deal exclusively or mostly with left-to-right scripts. Let’s take this HTML as a starting point: </p> <pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
  This is the first sentence.
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>important<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
     This is the second sentence, with some important info.
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  This is the third sentence.
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre> <p> As for styling, we’ll make the <code class="language-html">&lt;p&gt;</code> box quite narrow, <code class="language-css">width: 150px</code>. This will force the browser to flow the text into multiple lines. In other words, there will be multiple line boxes. </p> <p> We wil also style the <code class="language-html">&lt;span&gt;</code> element such that it has a left and right border, and a left and right padding: </p> <pre><code class="language-css"><span class="token selector">.important</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #dfdff9<span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> 5px solid #686892<span class="token punctuation">;</span>
  <span class="token property">border-right</span><span class="token punctuation">:</span> 5px solid #686892<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 10px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>The effect could be something like:</p> <img src="/images/8.6.2-inline-box-split-across-lines-in-ltr.svg" alt="A paragraph rendered in six lines of text. The second sentence begins
    on the second line, which is also where the first sentence ends. The second
    sentence ends on the fifth line, which is also where the third sentence
    begins. The second sentence has a light indigo background. Before the first 
    word of the sentence, there is a thick dark indigo border. There is also 
    a thick indigo border after the last word of the sentence."> <p> In these conditions, the <code class="language-html">&lt;span&gt;</code> element generates not one, but multiple inline boxes. This follows the rule expressed in <a href="https://www.w3.org/TR/CSS22/visuren.html#inline-formatting">Section&nbsp;9.4.2:</a> <q>When an inline box exceeds the width of a line box, it is split into several boxes and these boxes are distributed across several line boxes.</q> </p> <p> The interaction between the inline boxes created for the <code class="language-html">&lt;span&gt;</code> and the line boxes can be represented like this: </p> <img src="/images/8.6.2-inline-box-split-across-lines-in-ltr-annotated.svg" alt="A CSS box with six line boxes. The base direction of the box is left 
      to right. Each line box is marked with the letters
      LB, e.g.&nbsp;LB&nbsp;1, LB&nbsp;2. The CSS box contains an inline element,
      span, which is split across LB&nbsp;2, LB&nbsp;3, LB&nbsp;4, and LB&nbsp;5.
      Each of the inline boxes generated from the span is marked with the letters
      IB. IB&nbsp;1 is contained within LB&nbsp;2, IB&nbsp;2 within LB&nbsp;3,
      IB&nbsp;3 within LB&nbsp;4, and IB&nbsp;4 within LB&nbsp;5."> <p> The spec says <q>the left-most generated box of the first line box in which the element appears …</q>. In our example, this will be the inline box created for the words “This is”. The spec continues: <q>… has the left margin, left border and left padding</q>. As we can see in the example, this is the case: the border is placed to the left of “This is”. </p> <p> On the other hand, the inline box generated for the word “info” is the <code class="language-html">&lt;span&gt;</code>’s right-most inline box in line box&nbsp;5, i.e.&nbsp;in the last line box in which the <code class="language-html">&lt;span&gt;</code> is present. </p> <p> On the other hand, IB&nbsp;4 is the <code class="language-html">&lt;span&gt;</code>’s right-most inline box in LB&nbsp;5, i.e.&nbsp;in the last line box in which the <code class="language-html">&lt;span&gt;</code> is present. </p> <h3> Inline box layout when <code class="language-css">direction</code> is <code class="language-css">rtl</code> </h3> <p> The type of layout that we have just discussed is used when <code class="language-css">direction</code> is <code class="language-css">ltr</code>. Now, we’ll modify the example by assigning <code class="language-html">dir="rtl"</code> to the <code class="language-html">&lt;p&gt;</code> element. As discussed above, this attribute specification will set <code class="language-css">direction: rtl</code> in CSS. </p> <p> We’ll make one more addition: we’ll set <code class="language-css">text-align: left</code> on the <code class="language-html">&lt;p&gt;</code>. Without this intervention, the browser would right-align the text. I didn’t want that because I prefer to keep the example we’re going to see very similar to the previous. The browser would right-align the text because the initial value of <code class="language-css">text-align</code> is <q>a nameless value that acts as 'left' if 'direction' is 'ltr', 'right' if 'direction' is 'rtl'</q>, as specified in <a href="https://www.w3.org/TR/CSS22/text.html#propdef-text-align">Section&nbsp;16.2</a>. </p> <p> The diagram captures the results of making the two changes, <code class="language-html">dir="rtl"</code> and <code class="language-css">text-align: left</code>: </p> <img src="/images/8.6.2-inline-box-split-across-lines-in-rtl-annotated.svg" alt="A CSS box with six line boxes. The base direction of the box is 
    right to left. Each line box is marked with the letters LB,
    e.g.&nbsp;LB&nbsp;1, LB&nbsp;2. The CSS box contains an inline element,
    span, which is split across LB&nbsp;2, LB&nbsp;3, LB&nbsp;4, and LB&nbsp;5.
    Each of the inline boxes generated from the span is marked with the letters
    IB. IB&nbsp;1 is contained within LB&nbsp;2, IB&nbsp;2 within LB&nbsp;3,
    IB&nbsp;3 within LB&nbsp;4, and IB&nbsp;4 within LB&nbsp;5."> <p> The first line box in which the <code class="language-html">&lt;span&gt;</code> element appears is LB&nbsp;2. There, in LB&nbsp;2, there is only inline box originating from the <code class="language-html">&lt;span&gt;</code>, IB&nbsp;1. So, this only inline box is automatically the <code class="language-html">&lt;span&gt;</code>’s right-most box in LB&nbsp;2. </p> <p> According to the specification, IB&nbsp;1 should have the right margin, right border, and right padding defined for the <code class="language-html">&lt;span&gt;</code>, as shown in the diagram. This looks “wrong” for English, but is expected in languages with a right-to-left writing system. </p> <p> Conversely, IB&nbsp;4 should have the left margin, left border, and left padding defined for the <code class="language-html">&lt;span&gt;</code>, which is again captured in the diagram. </p> </div> <div class="copyright-notice"> <p> <img alt="Creative Commons License" src="/images/CC_BY-SA_small.svg"> This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Mateusz Sarnecki</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. </p> </div> </article> </main> <script src="/scripts/main.js"></script> <!-- GoatCounter, privacy-sensitive web analytics --> <script data-goatcounter="https://msar.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script> </body></html>