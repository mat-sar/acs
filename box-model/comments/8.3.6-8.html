<html lang="en"><head> <meta charset="utf-8"> <title>Width property in margins | Annotated CSS Spec </title> <meta name="description" content="Broaden your CSS knowledge by reading a specification enriched with explanations and examples."> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="robots" content="noindex"> <meta property="og:title" content="Annotated CSS Spec"> <meta property="og:url" content="https://annotatedcss.com"> <meta property="og:description" content="Broaden your CSS knowledge by reading an annotated specification!"> <meta property="og:image" content="/images/logo.png"> <meta property="og:type" content="website"> <meta property="og:image:width" content="300"> <meta property="og:image:height" content="300"> <link href="https://fonts.googleapis.com/css2?family=Inconsolata&amp;family=Open+Sans:ital,wght@0,400;0,600;1,300;1,400&amp;display=swap" rel="stylesheet"> <link rel="stylesheet" href="/styles/main.css"> <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96"> </head> <body> <header> <svg class="logo" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 41.01 41.01"><g class="marginBox" fill="none" stroke="#ececfb" stroke-width="2.646"><path d="M1.323 7.938V1.323h6.615M1.323 11.898v6.614M1.323 22.488v6.614M7.937 39.688H1.323v-6.615M39.688 7.938V1.323h-6.615M39.688 11.898v6.614M39.688 22.488v6.614M33.073 39.688h6.614v-6.615M11.906 1.318h6.615M22.49 1.318h6.614M11.906 39.688h6.615M22.49 39.688h6.614"></path></g><rect class="borderBox" ry="0" height="25.261" width="25.261" y="7.87" x="7.875" opacity=".99" fill="none" stroke="#ececfb" stroke-width="2.52" stroke-linecap="round"></rect><rect class="contentBox" ry="0" height="14.552" width="14.552" y="13.23" x="13.229" opacity=".99" fill="#c7a6e7ff"></rect></svg> <a class="title" href="/">Annotated CSS&nbsp;Spec </a><a class="help-link" href="/about">?</a> </header> <main> <article class="spec-comment open" data-comment-on="/box-model.html"> <div class="content"> <div class="comment-identifier"> This comment relates to the following words from Section&nbsp;8.3 of CSS&nbsp;2.2: <blockquote> The percentage is calculated with respect to the <em>width</em> of the generated box's <a href="https://www.w3.org/TR/CSS22/visuren.html#containing-block">containing block</a>. <span class="note">Note that this is true for <a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a> and <a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a> as well.</span> </blockquote> </div> <p> The spec fragment refers to containing blocks. A containing block is a rectangular area used for calculating a box’s size and position. You can find out more about containing blocks in <a href="https://www.w3.org/TR/CSS22/visudet.html#containing-block-details">Section&nbsp;10.1</a>. </p> <p>Let’s take this simple HTML:</p> <pre><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>child<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre> <p> If we assume the default styling for <code class="language-html">&lt;div&gt;</code> elements, the containing block of the child will be the content box of the parent. </p> <p> If you set <code class="language-css">margin-top: 50%</code> on the child, you might think that this 50% refers to the height of the containing block, i.e.&nbsp;the parent. This is not the case. The percentage value refers to the <em>width</em> of the containing block. </p> <p> Consider this example, in which the top margin of the inner box is set to 50%: </p> <div id="ex-8.3-6.i" class="example-visualization"> <style> #ex-8\.3-6\.i .parent {
          background-color: #b7bbf0;
          border: 1px solid #00075c;
          height: 100px;
          width: 20px;
        }

        #ex-8\.3-6\.i .child {
          border: 1px solid #00075c;
          background-color: #6872e0;
          height: 10px;
          margin-top: 50%;
        } </style> <div class="example-frame"> <div class="parent"> <div class="child"></div> </div> </div> </div> <p> The width of the parent’s content box is 20&nbsp;px. The child’s margin is 50% of that, i.e.&nbsp;10&nbsp;px. </p> <h3> Why does the percentage value always refer to the width of the containing block? </h3> <p> The rule discussed here can feel counterintuitive. Why is it even present in CSS? Why can’t something like <code class="language-css">margin-top: 5%</code> refer to the height of the containing block? </p> <p> For one, width-based calculation is typically less complex. At the moment the browser calculates margin sizes, the height of the containing block is often not yet known. On the other hand, the width is typically already calculated. </p> <p> Think about what happens when a browser lays out a page. The browser begins by calculating the box for the <code class="language-html">&lt;html&gt;</code> element. The width of that box is typically the width of the browser’s window, to use a little imprecise description. So, the box’s width is known right away. In contrast, the box’s height will depend on the other boxes. In fact, the height of the <code class="language-html">&lt;html&gt;</code> box will only be known once all the other boxes have been calculated. </p> <p> Similar logic, “width first, height last”, applies to the parent-child example above. When the browser is in the process of calculating the top margin for the child, the width of the parent is already known, but the height is yet to be determined. </p> <p> There is another reason why percentage values for <code class="language-css">margin-top</code> and <code class="language-css">margin-bottom</code> refer to the width and not the height of the containing block. </p> <p> If we do <code class="language-css">margin: 10%</code>, we might expect to see an even margin around the box. (If <em>you</em> wouldn’t expect this, just play along with me here.) </p> <p> Now, <code class="language-css">margin: 10%</code> is a shorthand notation representing four property specifications: </p> <ul> <li> <code class="language-css">margin-top: 10%;</code> </li> <li> <code class="language-css">margin-right: 10%;</code> </li> <li> <code class="language-css">margin-bottom: 10%;</code> </li> <li> <code class="language-css">margin-left: 10%;</code> </li> </ul> <p> So, if you use <code class="language-css">margin: 10%</code> and expect the same margin size on all sides of the box, then a specification such as <code class="language-css">margin-top: 10%</code> must always resolve to the same pixel value as, say, <code class="language-css">margin-left: 10%</code>. This conclusion is satisfied by interpreting all the percentage values as relating to the width of the containing block. </p> <h3>Undefined behaviour</h3> <p> Let’s return to the parent-child example, but with different CSS settings: </p> <pre><code class="language-css"><span class="token selector">.parent</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #b7bbf0<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #00075c<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.child</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #00075c<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #6872e0<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p> Here, the width of the parent depends on the width of the child. This is for two reasons. </p> <p> One, we do not enforce any fixed width on the parent simply by not specifying the <code class="language-css">width</code> property. This causes the browser to use the default <code class="language-css">width: auto</code>. </p> <p> Two, we set <code class="language-css">display: inline-block</code> on the parent. This value enables the “shrink-to-fit” width, as it’s called in the spec. Simply put, shrink-to-fit is about the box adapting its width to the width of its content. If we had not defined <code class="language-css">display: inline-block</code>, then the browser would apply the default <code class="language-css">display: block</code>. This would result in the parent box taking all available horizontal space and not depending on the child’s width. (You can refer to <a href="https://www.w3.org/TR/CSS22/visudet.html#shrink-to-fit-float">Section 10.3.5</a> for a description of shrink-to-fit.) </p> <p> So, the parent’s width depends on the child’s width. At the same time, we ask for the child’s margins to be 50% of the parent’s width. We have a chicken-and-egg problem: the width of the parent depends on the width of the child, and the width of the child (together with its margins) depends on the width of the parent. </p> <p> In such a situation, as the commented spec fragment says, <q>the resulting layout is undefined in CSS 2.2.</q>. That is, browsers can lay out the boxes as they see fit. </p> <p> CSS&nbsp;2 does not mandate any specific layout because of the complexity of the calculation. As Bert Bos, co⁠-⁠author of CSS, <a href="https://lists.w3.org/Archives/Public/www-style/2004Feb/0260.html">explained in the CSS mailing list</a>: <q> We might define it later. Could even require solving a system of equations. But not now.</q> </p> <p>Here is how your browser renders the example above:</p> <div id="ex-8.3-6.ii" class="example-visualization"> <style> #ex-8\.3-6\.ii .parent {
          background-color: #b7bbf0;
          border: 1px solid #00075c;
          display: inline-block;
        }

        #ex-8\.3-6\.ii .child {
          border: 1px solid #00075c;
          background-color: #6872e0;
          height: 50px;
          margin: 50%;
          width: 100px;
        } </style> <div class="example-frame"> <div class="parent"> <div class="child"></div> </div> </div> </div> <p> Today, most browsers seem to behave in a similar way. The logic they use seems to be: </p> <ol> <li> Calculate the width of the parent as if any percentage-based margin value of the child was <code class="language-css">0px</code>. (In our example, this is 52&nbsp;px.) </li> <li> Use the calculated parent width to compute the child’s left margin. (In our example, 26&nbsp;px, i.e. 50% of 52&nbsp;px.) </li> </ol> <!-- <p>
        You can use the fiddle at
        <a href="https://jsfiddle.net/3n5kLxvy/1/"
          >https://jsfiddle.net/3n5kLxvy/1/</a
        >
        to play with the example.
      </p> --> </div> <div class="copyright-notice"> <p> <img alt="Creative Commons License" src="/images/CC_BY-SA_small.svg"> This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Mateusz Sarnecki</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. </p> </div> </article> </main> <script src="/scripts/main.js"></script> <!-- GoatCounter, privacy-sensitive web analytics --> <script data-goatcounter="https://msar.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script> </body></html>